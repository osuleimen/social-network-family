# SMS-аутентификация - Инструкция по тестированию

## Обзор

Система аутентификации была переработана для использования только SMS-кодов вместо логина/пароля. Пользователи входят в систему, вводя номер телефона и получая SMS с кодом подтверждения.

## Основные изменения

1. **Убраны старые страницы**: LoginPage и RegisterPage больше не используются
2. **Основной способ входа**: PhoneAuthPage - единственная страница аутентификации
3. **SMS-верификация**: Все пользователи проходят верификацию по SMS
4. **Автоматическая регистрация**: Новые пользователи создаются автоматически при первом входе

## Тестирование

### Тестовый номер телефона

Для тестирования используйте номер: **+77019990438**

В тестовом режиме:
- SMS не отправляется на реальный номер
- Код подтверждения показывается в логах backend
- В frontend отображается индикатор "Тестовый режим"

### Пошаговое тестирование

1. **Запустите backend и frontend**
   ```bash
   # Backend
   cd social_network/backend
   python run.py
   
   # Frontend (в другом терминале)
   cd social_network/frontend
   npm run dev
   ```

2. **Откройте страницу аутентификации**
   - Перейдите на `/auth`
   - Введите номер +77019990438

3. **Получите код**
   - Нажмите "Получить код"
   - В backend логах появится сообщение: `TEST MODE: SMS code XXXX for +77019990438`
   - Скопируйте код из логов

4. **Введите код**
   - Введите 4-значный код в поле подтверждения
   - Нажмите "Подтвердить"

5. **Проверьте результат**
   - При успешной аутентификации вы будете перенаправлены на главную страницу
   - В localStorage сохранятся токены и данные пользователя

### Проверка логов

В backend терминале ищите сообщения:
```
TEST MODE: SMS code 1234 for +77019990438 - NOT sending actual SMS
TEST MODE: User should see this code in logs: 1234
```

## API Endpoints

- `POST /api/sms-auth/request-code` - Запрос SMS кода
- `POST /api/sms-auth/verify-code` - Проверка кода
- `POST /api/sms-auth/resend-code` - Повторная отправка кода

## Конфигурация SMS

SMS отправляется через Mobizon API:
- API Key: 7788b3700803c6a924862ad070d47013b403e20b
- URL: https://api.mobizon.kz/service/message/sendsmsmessage
- Отправитель: SocialNet

## Безопасность

- Коды действительны 10 минут
- Максимум 5 попыток ввода кода
- Повторная отправка доступна через 60 секунд
- Тестовый режим только для указанного номера

## Устранение неполадок

1. **Код не приходит**: Проверьте логи backend на наличие ошибок
2. **Неверный код**: Убедитесь, что используете код из логов (для тестового номера)
3. **Ошибки API**: Проверьте подключение к интернету и валидность API ключа

## Разработка

Для добавления новых тестовых номеров отредактируйте `self.test_phones` в `sms_service.py`.

